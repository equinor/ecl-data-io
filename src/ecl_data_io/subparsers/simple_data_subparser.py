from dataclasses import dataclass
from itertools import takewhile
from typing import List

from ecl_data_io.errors import ParsingError

from .record import Record
from .split_line import split_line
from .subparser import SubParser


class SimpleDataSubParser(SubParser):
    def __init__(self, keyword):
        self._keyword = keyword

    @property
    def keyword(self):
        return self._keyword

    def parse(self, super_parser, lines):
        try:
            contents = []
            while True:
                for word in split_line(next(lines)):
                    if word[0] == "/":
                        yield Record(self.keyword, contents)
                        return
                    contents.append(word)

        except StopIteration as e:
            raise ParsingError(
                f"Reached end of file while parsing keyword {self.keyword}"
            ) from e


simple_data_keywords = [
    "ACTCO2S",
    "ACTDIMS",
    "ACTNUM",
    "ACTPARAM",
    "AIMCON",
    "AIMFRAC",
    "AIMPVI",
    "AJGPARAM",
    "ALPHANUD",
    "ALPHANUI",
    "ALPHANUM",
    "APIGROUP",
    "APILIM",
    "AQCOEF",
    "AQUCWFAC",
    "AQUDIMS",
    "AQUTAB",
    "ASPDEPO",
    "ASPFLOC",
    "ASPFLRT",
    "ASPHALTE",
    "ASPKDAM",
    "ASPLCRT",
    "ASPP1P",
    "ASPP2P",
    "ASPREWG",
    "ASPVISO",
    "ASPWETF",
    "AUTOREF",
    "AUTOSAVE",
    "BAKER1",
    "BAKER2",
    "BOUNDARY",
    "BOX",
    "BPARA",
    "BPDIMS",
    "BRINE",
    "BTOBALFA",
    "BTOBALFV",
    "CALTRAC",
    "CALVAL",
    "CATYPE",
    "CBMOPTS",
    "CFLLIMIT",
    "CHANDIMS",
    "CNAMES",
    "COALNUM",
    "COMPS",
    "COMPSOL",
    "COMPVD",
    "COMPVE",
    "COMPVEL",
    "COORD",
    "CPR",
    "CRITPERM",
    "COMPW",
    "CVCRIT",
    "CWTYPE",
    "DATUM",
    "DATUMR",
    "DBGODD3P",
    "DCQDEFN",
    "DEBUG",
    "DEBUG3",
    "DELAYACT",
    "DEPTH",
    "DGRDT",
    "DGRID",
    "DIFFCGAS",
    "DIFFCGO",
    "DIFFCGW",
    "DIFFCOG",
    "DIFFCOIL",
    "DIFFCWG",
    "DIFFMMF",
    "DIFFMR",
    "DIFFMR-",
    "DIFFMTHT",
    "DIFFMTH-",
    "DIFFMX",
    "DIFFMX-",
    "DIFFMY",
    "DIFFMY-",
    "DIFFMZ",
    "DIFFMZ-",
    "DIFFR",
    "DIFFTGAS",
    "DIFFTHT",
    "DIFFTOIL",
    "DIFFX",
    "DIFFY",
    "DIFFZ",
    "DIMENS",
    "DIMPES",
    "DISPDIMS",
    "DNGL",
    "DOMAIN",
    "DOMAINS",
    "DPCDT",
    "DPNUM",
    "DR",
    "DRILPRI",
    "DRSDT",
    "DRV",
    "DRVDT",
    "DSTNUM",
    "DTHETA",
    "DTHETAV",
    "DUMPCUPL",
    "DX",
    "DXV",
    "DY",
    "DYV",
    "DZ",
    "DZV",
    "DYNRDIMS",
    "DZMATRIX",
    "DZMATRX",
    "DZMATRXV",
    "DZNET",
    "EHYSTR",
    "CARFIN",
    "ENDNUM",
    "ENDSCALE",
    "EOSNUM",
    "EPSCOMP",
    "EPSDEBUG",
    "EQLDIMS",
    "EQLDKVCR",
    "EQLDTAB",
    "EQLNUM",
    "EQLOPTS",
    "EXCAVATE",
    "EXTFIN",
    "EXTHOST",
    "EXTRAPMS",
    "EXTREPGL",
    "FACTLI",
    "FAULTDIM",
    "FBHPDEF",
    "FCCRIT",
    "FILEUNIT",
    "FIPNUM",
    "FLASHOPT",
    "FLUXNUM",
    "FLUXOPTS",
    "FLUXREG",
    "FLUXTYPE",
    "FOAMOPTS",
    "FORMFEED",
    "FORMOPTS",
    "FRICTION",
    "FVST",
    "GASADCO",
    "GASADEC",
    "GASCCMP",
    "GASCONC",
    "GASFDECR",
    "GASFDELC",
    "GASFIELD",
    "GASFTARG",
    "GASMONTH",
    "GASPERIO",
    "GASSATC",
    "GASSOL",
    "GASVISCF",
    "GASVISCT",
    "GASYEAR",
    "GCONTOL",
    "GDFILE",
    "GDIMS",
    "GDORIENT",
    "GETDATA",
    "GI",
    "GPTABLE",
    "GPTABLEN",
    "GPTABLE3",
    "GPTDIMS",
    "GRAVCONS",
    "GRAVDRM",
    "GRIDFILE",
    "GRIDOPTS",
    "GRIDUNIT",
    "GSF",
    "GSSCPTST",
    "GUIDECAL",
    "GUIDERAT",
    "GUPFREQ",
    "HBNUM",
    "HEATCR",
    "HEATCRT",
    "HEATDIMS",
    "HEATTTHT",
    "HEATTR",
    "HEATTX",
    "HEATTY",
    "HEATTZ",
    "HMDIMS",
    "HMMULTSG",
    "HRFIN",
    "HSGRO",
    "HSGRW",
    "HSORG",
    "HSORW",
    "HSWRG",
    "HSWRO",
    "HWKRO",
    "HWKRORG",
    "HWKRORW",
    "HWKRW",
    "HWKRWR",
    "HWPCW",
    "HWSNUM",
    "HWSOGCR",
    "HWSOWCR",
    "HWSWCR",
    "HWSWL",
    "HWSWLPC",
    "HWSWU",
    "HXFIN",
    "HYDRHEAD",
    "HYFIN",
    "HYSTCHCK",
    "HZFIN",
    "IMBNUM",
    "IMBNUMMF",
    "IMKRVD",
    "IMPCVD",
    "IMPORT",
    "IMPTVD",
    "IMSPCVD",
    "INCLUDE",
    "INRAD",
    "INTPC",
    "IONROCK",
    "IPCW",
    "IPCG",
    "ISGL",
    "ISGLPC",
    "ISGCR",
    "ISGU",
    "ISWL",
    "ISWLPC",
    "ISWCR",
    "ISWU",
    "ISOGCR",
    "ISOWCR",
    "ISOLNUM",
    "ISTNUM",
    "JALS",
    "JFUNC",
    "IKRG",
    "IKRGR",
    "KRG",
    "KRGX",
    "KRGX-",
    "KRGY",
    "KRGY-",
    "KRGZ",
    "KRGZ-",
    "KRGR",
    "KRGRX",
    "KRGRX-",
    "KRGRY",
    "KRGRY-",
    "KRGRZ",
    "KRGRZ-",
    "KRNUM",
    "KRNUMX",
    "KRNUMX-",
    "KRNUMY",
    "KRNUMY-",
    "KRNUMZ",
    "KRNUMZ-",
    "KRNUMR",
    "KRNUMR-",
    "KRNUMT",
    "KRNUMT-",
    "KRNUMMF",
    "KRO",
    "KROX",
    "KROX-",
    "KROY",
    "KROY-",
    "KROZ",
    "KROZ-",
    "KRORW",
    "KRORG",
    "KRORWX",
    "KRORGX",
    "KRORWX-",
    "KRORGX-",
    "KRORWY",
    "KRORGY",
    "KRORWY-",
    "KRORGY-",
    "KRORWZ",
    "KRORGZ",
    "KRORWZ-",
    "KRORGZ-",
    "KRW",
    "KRWX",
    "KRWX-",
    "KRWY",
    "KRWY-",
    "KRWZ",
    "KRWZ-",
    "KRWR",
    "KRWRX",
    "KRWRX-",
    "KRWRY",
    "KRWRY-",
    "KRWRZ",
    "KRWRZ-",
    "KVCOMP",
    "KVGEN",
    "KVMF",
    "KVTABC1",
    "KVTABC2",
    "KVTABC3",
    "KVTABC4",
    "KVTABC5",
    "KVTABC6",
    "KVTABC7",
    "KVTABC8",
    "KVTABC9",
    "KVTABLE",
    "KVTABT1",
    "KVTABT2",
    "KVTABT3",
    "KVTABT4",
    "KVTABT5",
    "KVTABT6",
    "KVTABT7",
    "KVTABT8",
    "KVTABT9",
    "KVTEMP",
    "LAGTRAC",
    "LAGTRUPD",
    "LANGMPL",
    "LANGMULC",
    "LANGMULT",
    "LBCCOEF",
    "LCUNIT",
    "LGR",
    "LGROFF",
    "LGRON",
    "LIFTOPT",
    "LILIM",
    "LINCOM",
    "LINKPERM",
    "LKRO",
    "LKROG",
    "LKROW",
    "LKRW",
    "LKRWR",
    "LOAD",
    "LPCW",
    "LSCRIT",
    "LSLTWNUM",
    "LSNUM",
    "LSOGCR",
    "LSOWCR",
    "LSWCR",
    "LSWL",
    "LSWLPC",
    "LSWU",
    "LTOSIGMA",
    "LUMPDIMS",
    "LWKRO",
    "LWKRORG",
    "LWKRORW",
    "LWKRW",
    "LWPCW",
    "LWSLTNUM",
    "LWSNUM",
    "LWSOGCR",
    "LWSOWCR",
    "LWSWCR",
    "LWSWL",
    "LWSWLPC",
    "LWSWU",
    "LX",
    "LXFIN",
    "LY",
    "LYFIN",
    "LZ",
    "LZFIN",
    "MAPAXES",
    "MAPUNITS",
    "MATCORR",
    "MAXTRANZ",
    "MEMORY",
    "MESSAGES",
    "MESSOPTS",
    "MESSSRVC",
    "MIDS",
    "MINDZNET",
    "MINNNCT",
    "MINPORV",
    "MINPORV9",
    "MINPV",
    "MINPVV",
    "MINROCKV",
    "MINRV",
    "MISC",
    "MISCEXP",
    "MISCIBLE",
    "MISCNUM",
    "MISCSTR",
    "MISCSTRP",
    "MLANG",
    "MLANGSLV",
    "MPFA",
    "MPFANUM",
    "MSGFILE",
    "MULSGGD",
    "MULSGGDV",
    "MULTMF",
    "MULTNUM",
    "MULTPV",
    "MULTR",
    "MULTR-",
    "MULTREAL",
    "MULTSAVE",
    "MULTSIG",
    "MULTSIGV",
    "MULTTHT",
    "MULTTHT-",
    "MULTX",
    "MULTX-",
    "MULTY",
    "MULTY-",
    "MULTZ",
    "MULTZ-",
    "NCOMPS",
    "NEI",
    "NETBALAN",
    "NETWORK",
    "NEXT",
    "NEXTSTEP",
    "NEXTSTEPL",
    "NINENUM",
    "NMATOPTS",
    "NMATRIX",
    "NNEWTF",
    "NOHMD",
    "NOHMO",
    "NRSOUT",
    "NSTACK",
    "NTG",
    "NUMRES",
    "NUPCOL",
    "NXFIN",
    "NYFIN",
    "NZFIN",
    "OILAPI",
    "OILCOMPR",
    "OILMW",
    "OILSPECH",
    "OILVTIM",
    "OPERNUM",
    "OPTDIMS",
    "OPTIONS",
    "OPTIONS3",
    "OPTLOAD",
    "OPTODD3P",
    "OPTOPTS",
    "OPTTUNE",
    "ORTHERRO",
    "ORTHERRX",
    "ORTHERRY",
    "ORTHERRZ",
    "OUTRAD",
    "OVERTR",
    "OVERTTHT",
    "OVERTX",
    "OVERTY",
    "OVERTZ",
    "PARACHOR",
    "PARALLEL",
    "PARAOPTS",
    "PARTTRAC",
    "PBUB",
    "PBVD",
    "PCG",
    "PCW",
    "PDEW",
    "PDIVX",
    "PDIVY",
    "PEBI",
    "PEDIMS",
    "PEDTUNE",
    "PENUM",
    "PERMAVE",
    "PERMJFUN",
    "PERMMF",
    "PERMR",
    "PERMTHT",
    "PERMX",
    "PERMY",
    "PERMZ",
    "PERMXX",
    "PERMXY",
    "PERMXZ",
    "PERMYX",
    "PERMYY",
    "PERMYZ",
    "PERMZX",
    "PERMZY",
    "PERMZZ",
    "PETGRID",
    "PETOPTS",
    "PICOND",
    "PIMTDIMS",
    "PINCH",
    "PINCHNUM",
    "PINCHXY",
    "PLMIXNUM",
    "PLYATEMP",
    "PLYCAMAX",
    "PLYKRRF",
    "PLYOPTS",
    "PLYRMDEN",
    "PLYTRRFA",
    "PMANUM",
    "PMAX",
    "PORO",
    "PORV",
    "PRESSURE",
    "PRIORITY",
    "PSGRO",
    "PSGRW",
    "PSORG",
    "PSORW",
    "PSTEADY",
    "PSTNUM",
    "PSWRG",
    "PSWRO",
    "PVTNUM",
    "QDRILL",
    "QMOBIL",
    "RADFIN",
    "RADFIN4",
    "RAINFALL",
    "RCMASTS",
    "REACACT",
    "REACCRIT",
    "REACENTH",
    "REACOPS",
    "REACRATE",
    "REACSMAX",
    "REACSORD",
    "REACTION",
    "READDATA",
    "RECOVERY",
    "REFINE",
    "REGDIMS",
    "RESIDNUM",
    "RESTART",
    "RESVNUM",
    "RIVDEBUG",
    "RIVRDIMS",
    "ROCKCOMP",
    "ROCKDEN",
    "ROCKDIMS",
    "ROCKFRAC",
    "ROCKNUM",
    "ROCKOPTS",
    "ROCKSPLV",
    "ROCKTRMX",
    "ROCKTRMY",
    "ROCKTRMZ",
    "ROCKV",
    "ROMF",
    "RPTCPL",
    "RPTGRID",
    "RPTGRIDL",
    "RPTHMD",
    "RPTINIT",
    "RPTOPT",
    "RPTPRINT",
    "RPTPROPS",
    "RPTREGS",
    "RPTRST",
    "RPTSCHED",
    "RPTSLN",
    "RPTSMRY",
    "RPTSOL",
    "RS",
    "RSCONST",
    "RSW",
    "RSWVD",
    "RTEMP",
    "RTEMPA",
    "RTEMPVD",
    "RV",
    "RVCONST",
    "SAKRO",
]
